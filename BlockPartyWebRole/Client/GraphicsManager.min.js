var GraphicsManager=function(){function n(n,t){this.game=n,this.canvas=t[0],this.canvasContext=this.canvas.getContext("2d"),this.backBuffer=document.createElement("canvas"),this.backBuffer.width=this.canvas.width,this.backBuffer.height=this.canvas.height,this.backBufferContext=this.backBuffer.getContext("2d");var i=this;$(window).resize(function(){setTimeout(function(){i.WindowResized()},250)}),this.WindowResized()}return n.prototype.WindowResized=function(){var n=this;this.UpdateDimensions(),setTimeout(function(){n.UpdateDimensions()},1500)},n.prototype.UpdateDimensions=function(){var n,t,r=window.innerWidth/window.innerHeight,i=this.game.WorldViewport.Width/this.game.WorldViewport.Height;r>i?(n=window.innerHeight*i,t=window.innerHeight):(n=window.innerWidth,t=window.innerWidth/i),this.canvas.style.width=n+"px",this.canvas.style.height=t+"px",this.canvas.width=n,this.canvas.height=t,this.backBuffer.width=n,this.backBuffer.height=t,this.canvas.style.left=(window.innerWidth-this.canvas.width)/2+"px",this.canvas.style.top=(window.innerHeight-this.canvas.height)/2+"px"},n.prototype.DrawLine=function(n,t,i,r){var u=this.TransformWorldToCanvas(n),f=this.TransformWorldToCanvas(t);this.backBufferContext.save(),this.backBufferContext.beginPath(),this.backBufferContext.strokeStyle=r,this.backBufferContext.lineWidth=i,this.backBufferContext.moveTo(u.X,u.Y),this.backBufferContext.lineTo(f.X,f.Y),this.backBufferContext.stroke(),this.backBufferContext.restore()},n.prototype.DrawRectangle=function(n,t,i,r,u,f){var e=this.TransformWorldToCanvas(n),o=this.TransformWorldToCanvasX(t),s=this.TransformWorldToCanvasY(i);this.backBufferContext.save(),this.backBufferContext.lineWidth=r,u&&(this.backBufferContext.strokeStyle=u,this.backBufferContext.strokeRect(e.X,e.Y,o,s)),f&&(this.backBufferContext.fillStyle=f,this.backBufferContext.fillRect(e.X,e.Y,o,s)),this.backBufferContext.restore()},n.prototype.DrawFullscreenRectangle=function(n){this.backBufferContext.save(),this.backBufferContext.globalCompositeOperation="lighter",this.backBufferContext.fillStyle=n,this.backBufferContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.backBufferContext.restore()},n.prototype.DrawCircle=function(n,t,i,r,u){var f=this.TransformWorldToCanvas(n),e=this.TransformWorldToCanvasX(t);this.backBufferContext.save(),this.backBufferContext.beginPath(),this.backBufferContext.lineWidth=i,this.backBufferContext.arc(f.X,f.Y,e,0,Math.PI*2,!0),u?(this.backBufferContext.fillStyle=r,this.backBufferContext.fill()):(this.backBufferContext.strokeStyle=r,this.backBufferContext.stroke()),this.backBufferContext.restore()},n.prototype.Draw=function(n,t){var i=this.TransformWorldToCanvasRectangle(t);this.backBufferContext.save(),this.backBufferContext.drawImage(n,i.X,i.Y,i.Width,i.Height),this.backBufferContext.restore()},n.prototype.DrawText=function(n,t,i){var r=this.TransformWorldToCanvas(t);this.backBufferContext.save(),this.backBufferContext.font="bold 24px Arial",this.backBufferContext.textBaseline="top",this.backBufferContext.fillStyle=i,this.backBufferContext.fillText(n,r.X,r.Y),this.backBufferContext.restore()},n.prototype.Clear=function(){this.backBufferContext.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.Present=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvasContext.globalAlpha=this.GlobalAlpha,this.canvasContext.drawImage(this.backBuffer,0,0)},n.prototype.TransformWorldToCanvas=function(n){return new Vector2(n.X*this.canvas.width/this.game.WorldViewport.Width,n.Y*this.canvas.height/this.game.WorldViewport.Height)},n.prototype.TransformWorldToCanvasRectangle=function(n){return new Rectangle(n.X*this.canvas.width/this.game.WorldViewport.Width,n.Y*this.canvas.height/this.game.WorldViewport.Height,n.Width*this.canvas.width/this.game.WorldViewport.Width,n.Height*this.canvas.height/this.game.WorldViewport.Height)},n.prototype.TransformWorldToCanvasX=function(n){return n*this.canvas.width/this.game.WorldViewport.Width},n.prototype.TransformWorldToCanvasY=function(n){return n*this.canvas.height/this.game.WorldViewport.Height},n}()